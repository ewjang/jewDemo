<!DOCTYPE HTML>
<html>
    <head>
        <title>로그인</title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <link rel="stylesheet" href="index.css">
    </head>

    <body>
        <div class="login-container">
            <div class="login-header">
                <h1>로그인</h1>
                <p>계정에 로그인하세요</p>
            </div>

            <form id="loginForm">
                <div class="form-group">
                    <label for="username">아이디</label>
                    <input type="text" id="username" name="username" placeholder="아이디를 입력하세요" required>
                </div>

                <div class="form-group">
                    <label for="password">비밀번호</label>
                    <input type="password" id="password" name="password" placeholder="비밀번호를 입력하세요" required>
                </div>

                <div class="remember-me">
                    <input type="checkbox" id="remember" name="remember">
                    <label for="remember">로그인 상태 유지</label>
                </div>

                <button type="submit" class="login-btn">로그인</button>
            </form>

            <script src="/js/modal.js"></script>
            <script>
                document.getElementById('loginForm').addEventListener('submit', function(e) {
                    e.preventDefault();

                    const username = document.getElementById('username').value;
                    const password = document.getElementById('password').value;

                    fetch('/login', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ username: username, password: password }),
                        credentials: 'include'
                    })
                    .then(response => {
                        if (response.ok) return response.json();
                        return response.json().then(err => { throw new Error(err.error || '로그인 실패'); });
                    })
                    .then(data => {
                        window.location.href = '/dashboard';
                    })
                    .catch(error => {
                        showModal(error.message || '로그인 처리 중 오류가 발생했습니다.', 'error');
                    });
                });
            </script>

            <div class="links-container">
                <a href="/signup">회원가입</a>
                <a href="/forgot-password">비밀번호 찾기</a>
            </div>
        </div>
    </body>
</html>